---
import Layout from "../layouts/Layout.astro";
import Hero from "../components/Hero.astro";

import Services from "../components/Services.astro";
import Testimonials from "../components/Testimonials.astro";
import CTA from "../components/CTA.astro";

import { siteConfig } from "../config/site";
import { homePageConfig } from "../config/pages";

// Extract sections from config
const heroSection = homePageConfig.sections.find(
    (section) => section.type === "hero",
);
const welcomeSection = homePageConfig.sections.find(
    (section) => section.type === "welcome",
);
const servicesSection = homePageConfig.sections.find(
    (section) => section.type === "services",
);
const testimonialsSection = homePageConfig.sections.find(
    (section) => section.type === "testimonials",
);
const ctaSection = homePageConfig.sections.find(
    (section) => section.type === "cta",
);
---

<Layout title={siteConfig.name} description={siteConfig.description}>
    <Hero />
    <Services showAllServices={false} limit={3} />
    <Testimonials />
    <CTA />
</Layout>
<Layout
    title={homePageConfig.title}
    description={homePageConfig.description}
    ogImage={homePageConfig.ogImage}
>
    {
        heroSection && (
            <Hero
                title={heroSection.title}
                subtitle={heroSection.subtitle}
                ctaPrimary={heroSection.ctaPrimary.text}
                ctaSecondary={heroSection.ctaSecondary?.text}
                ctaPrimaryLink={heroSection.ctaPrimary.link}
                ctaSecondaryLink={heroSection.ctaSecondary?.link}
                imageUrl={heroSection.imageUrl}
            />
        )
    }

    {
        servicesSection && (
            <Services
                sectionTitle={servicesSection.title}
                sectionSubtitle={servicesSection.subtitle}
                showAllServices={servicesSection.showAllServices}
                limit={servicesSection.limit}
            />
        )
    }

    {
        testimonialsSection && (
            <Testimonials
                title={testimonialsSection.title}
                subtitle={testimonialsSection.subtitle}
                testimonials={testimonialsSection.testimonials}
            />
        )
    }

    {
        ctaSection && (
            <CTA
                title={ctaSection.title}
                subtitle={ctaSection.subtitle}
                ctaText={ctaSection.ctaPrimary.text}
                ctaLink={ctaSection.ctaPrimary.link}
                secondaryText={ctaSection.ctaSecondary?.text}
                secondaryLink={ctaSection.ctaSecondary?.link}
            />
        )
    }
</Layout>
